%%
%% This is file `hustthesis-doc.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% hustthesis.dtx  (with options: `doc-sty')
%% 
%%     Copyright (C) 2013-2014 by Xu Cheng <xucheng@me.com>
%%                   2014-     by hust-latex <https://github.com/hust-latex>
%%                   2024-     by HUANG Yuxi <hustthesis@hyxi.dev>
%% 
%%     This work may be distributed and/or modified under the
%%     conditions of the LaTeX Project Public License, either
%%     version 1.3c of this license or (at your option) any later
%%     version. This version of this license is in
%%        https://www.latex-project.org/lppl/lppl-1-3c.txt
%%     and the latest version of this license is in
%%        https://www.latex-project.org/lppl.txt
%%     and version 1.3c or later is part of all distributions of LaTeX
%%     version 2008 or later.
%% 
%%     This work has the LPPL maintenance status "maintained".
%% 
%%     The Current Maintainer of this work is HUANG Yuxi <hustthesis@hyxi.dev>.
%% 

\ProvidesExplClass{hustthesis-doc}
  {2025-02-27}{2.0.0} %
  {Documentation for the hustthesis class}


\RequirePackage
  {
    ulem,
    xcolor-material,
    zref-base,
    listings,
  }
\cs_new_protected:Npn \__hustdoc_patch_cmd:Nnn #1#2#3
  {
    \ctex_patch_cmd_once:NnnnTF #1 { } {#2} {#3}
      { } { \ctex_patch_failure:N #1 }
  }
\cs_new_protected:Npn \__hustdoc_preto_cmd:Nn #1#2
  {
    \ctex_preto_cmd:NnnTF #1 { } {#2}
      { } { \ctex_patch_failure:N #1 }
  }
\cs_new_protected:Npn \__hustdoc_appto_cmd:Nn #1#2
  {
    \ctex_appto_cmd:NnnTF #1 { } {#2}
      { } { \ctex_patch_failure:N #1 }
  }
\__hustdoc_patch_cmd:Nnn \__codedoc_typeset_expandability:
  { & } { & \skip_horizontal:n { -0.5em } }
\__hustdoc_preto_cmd:Nn \__codedoc_typeset_functions:
  { \MacroFont }
\__hustdoc_patch_cmd:Nnn \__codedoc_macro_init:
  { \hbox:n } { \MacroFont \hbox:n }
\__hustdoc_patch_cmd:Nnn \__codedoc_macro_dump:
  { \hbox_unpack_drop:N } { \MacroFont \hbox_unpack_drop:N }
\cs_set_protected:Npn \__codedoc_macro_typeset_one:nN #1#2
  {
    \vbox_set:Nn \l__codedoc_macro_box
      {
        \MacroFont
        \vbox_unpack_drop:N \l__codedoc_macro_box
        \hbox_set:Nn \l_tmpa_box
          { \__codedoc_print_macroname:nN {#1} #2 }
        \dim_set:Nn \l_tmpa_dim
          { \marginparwidth - \labelsep - \marginparsep }
        \dim_compare:nNnT { \box_wd:N \l_tmpa_box } > \l_tmpa_dim
          {
            \box_resize_to_wd_and_ht:Nnn \l_tmpa_box
              { \l_tmpa_dim } { \box_ht:N \l_tmpa_box }
          }
        \hbox_overlap_left:n
          {
            \box_use:N \l_tmpa_box
            \skip_horizontal:n { \marginparsep - \labelsep }
          }
      }
    \int_incr:N \l__codedoc_macro_int
  }
\DeclareDocumentCommand \key { O{option} m }
  {
    \tl_if_eq:nnTF { #1 } { option }
      { \cmd[module=#1/]{#2} }
      { \cmd[module=#1/]{#1/#2} }
  }
\DeclareDocumentCommand \opt { s m }
  { \IfBooleanTF {#1} { \texttt{\bfseries \upshape #2} } { \texttt{\upshape #2} } }
\newcommand\expstar{$\star$}
\newcommand\rexpstar{\ding{73}}
\def\TeX{\hologo{TeX}}
\def\LaTeX{\hologo{LaTeX}}
\def\LaTeXe{\hologo{LaTeXe}}
\def\pdfTeX{\hologo{pdfTeX}}
\def\pdfLaTeX{\hologo{pdfLaTeX}}
\def\XeTeX{\hologo{XeTeX}}
\def\XeLaTeX{\hologo{XeLaTeX}}
\def\LuaTeX{\hologo{LuaTeX}}
\def\LuaLaTeX{\hologo{LuaLaTeX}}
\def\AmSLaTeX{\hologo{AmSLaTeX}}
\def\TeXLive{\TeX\ Live}
\def\MiKTeX{\hologo{MiKTeX}}
\def\BibTeX{\hologo{BibTeX}}
\def\biber{\hologo{biber}}
\def\TikZ{Ti\emph{k}Z}
\lstdefinestyle{style@base}
  {
    basewidth = 0.5 em,
    gobble = 3,
    lineskip = 3 pt,
    frame = l,
    framerule = 1 pt,
    framesep = 0 pt,
    xleftmargin = 2 em,
    xrightmargin = 3 em,
    escapeinside = {(*}{*)},
    breaklines = true,
    basicstyle = \small\ttfamily,
    keywordstyle = \bfseries\color{purple},
    commentstyle = \itshape\color{white!50!gray},
    stringstyle = \color{red},
    backgroundcolor = \color{white!95!gray}
  }
\lstdefinestyle{style@bash}
  {
    style = style@base,
    rulecolor = \color{pink},
    language = bash,
    alsoletter = {-},
    emphstyle = \color{green}
  }
\lstdefinestyle{style@latex}
  {
    style = style@base,
    rulecolor = \color{blue},
    language = [LaTeX]TeX,
    alsoletter = {*, -, .},
    texcsstyle = *\color{purple},
    emphstyle = [1]\color{orange},
    emphstyle = [2]\color{green},
    emphstyle = [3]\bfseries\color{yellow}
  }
\lstnewenvironment{bashecode}[1][]{%
  \lstset{style=style@bash, #1}}{}
\lstnewenvironment{latexcode}[1][]{%
  \lstset{style=style@latex, #1}}{}
\cs_set_protected_nopar:Npn \xmacro@code
  { \__hustdoc_marco_code:w }
\cs_set_protected_nopar:Npn \sxmacro@code
  {
    \fontspec_print_visible_spaces:
    \xmacro@code
  }
\cs_new_protected_nopar:Npn \__hustdoc_marco_code:w
  {
    \ifcodeline@index
      \__hustdoc_marco_code_every_par:n { \__hustdoc_code_line_no: }
    \else:
      \__hustdoc_marco_code_every_par:n { }
    \fi:
    \__hustdoc_make_finish_tag:x { \@currenvir }
    \__hustdoc_macro_code_start:w
  }
\cs_new_protected:Npn \__hustdoc_marco_code_every_par:n #1
  {
    \everypar
      {
        \everypar {#1}
        \if@inlabel
          \global \@inlabelfalse \@noparlistfalse
          \llap { \box \@labels \hskip \leftskip }
        \fi
        #1
      }
  }
\group_begin:
  \int_set:Nn \tex_endlinechar:D { -1 }
  \use:n
    {
      \char_set_catcode_active:n { 32 }
      \tl_const:Nn \c__hustdoc_active_space_tl
    }
    { }
\group_end:
\group_begin:
  \char_set_catcode_active:n { 13 }
  \cs_new_protected:Npx \__hustdoc_make_finish_tag:n #1
    {
      \tl_set:Nn \exp_not:N \l__hustdoc_macro_code_finish_tl
        {
          \c_percent_str
          \prg_replicate:nn { 4 }
            { \exp_not:o { \c__hustdoc_active_space_tl } }
          \exp_not:o { \active@escape@char } end
          \c_left_brace_str #1 \c_right_brace_str
          \exp_not:N ^^M
        }
    }
  \cs_generate_variant:Nn \__hustdoc_make_finish_tag:n { x }
  \cs_new_protected:Npn \__hustdoc_macro_code_start:w #1
    {
      \str_if_eq:nnTF {#1} { ^^M }
        { \__hustdoc_macro_code_read_line:w }
        { \__hustdoc_macro_code_read_line:w #1 }
    }
  \cs_new_protected:Npn \__hustdoc_macro_code_read_line:w #1 ^^M
    {
      \tl_set:Nn \l__hustdoc_macro_code_line_tl { #1 ^^M }
      \tl_if_eq:NNTF
        \l__hustdoc_macro_code_line_tl \l__hustdoc_macro_code_finish_tl
        { \exp_args:Nx \end { \@currenvir } }
        {
          \__hustdoc_macro_code_process_line:
          \__hustdoc_macro_code_read_line:w
        }
    }
  \cs_new_protected:Npn \__hustdoc_swap_cr:
    {
      \exp_after:wN
        \__hustdoc_swap_cr_aux:w \l__hustdoc_macro_code_line_tl
    }
  \cs_new_protected:Npn \__hustdoc_swap_cr_aux:w #1 ^^M
    {
      \group_insert_after:N ^^M
      \tl_set:Nn \l__hustdoc_macro_code_line_tl {#1}
    }
  \tl_const:Nn \c__hustdoc_active_cr_tl { ^^M }
\group_end:
\tl_new:N \l__hustdoc_macro_code_line_tl
\tl_new:N \l__hustdoc_macro_code_finish_tl
\tl_new:N \g__hustdoc_macro_code_verbatim_stop_tl
\cs_new_protected_nopar:Npn \__hustdoc_process_normal_line:
  {
    \str_case_e:nnF
      { \str_head:N \l__hustdoc_macro_code_line_tl }
      {
        { \c_percent_str }
        {
          \__hustdoc_check_angle:x
            { \tl_tail:N \l__hustdoc_macro_code_line_tl }
        }
        { \c_hash_str }
        { \__hustdoc_output_comment_line: }
      }
      { \__hustdoc_output_line: }
  }
\cs_new_protected_nopar:Npn \__hustdoc_process_verbatim_line:
  {
    \tl_if_eq:NNTF \l__hustdoc_macro_code_line_tl
        \g__hustdoc_macro_code_verbatim_stop_tl
      {
        \tl_gclear:N \g__hustdoc_macro_code_verbatim_stop_tl
        \cs_gset_eq:NN \__hustdoc_macro_code_process_line:
          \__hustdoc_process_normal_line:
        \__hustdoc_output_module:nn
          { \color { verb@guard } }
          {
            \__hustdoc_swap_cr:
            \__hustdoc_module_pop:n { \l__hustdoc_macro_code_line_tl }
          }
      }
      { \tl_use:N \l__hustdoc_macro_code_line_tl }
  }
\cs_new_eq:NN \__hustdoc_macro_code_process_line:
  \__hustdoc_process_normal_line:
\DeclareDocumentCommand \CheckModules { }
  {
    \cs_set_eq:NN \__hustdoc_macro_code_process_line:
      \__hustdoc_process_normal_line:
  }
\DeclareDocumentCommand \DontCheckModules { }
  {
    \cs_set_eq:NN \__hustdoc_macro_code_process_line:
      \__hustdoc_output_line:
  }
\cs_new_protected:Npn \__hustdoc_check_angle:n #1
  {
    \str_if_eq:eeTF { \str_head:n {#1} } { < }
      { \__hustdoc_check_module:x { \tl_tail:n {#1} } }
      { \__hustdoc_output_comment_line: }
  }
\cs_generate_variant:Nn \__hustdoc_check_angle:n { x }
\cs_new_protected:Npn \__hustdoc_check_module:n #1
  {
    \str_case_e:nnF { \str_head:n {#1} }
      {
        { * } { \__hustdoc_module_star:w }
        { / } { \__hustdoc_module_slash:w }
        { @ } { \__hustdoc_module_at:w }
        { < } { \__hustdoc_module_verb:w }
      }
      { \__hustdoc_module_pm:w }
    #1 \q_stop
  }
\cs_generate_variant:Nn \__hustdoc_check_module:n { x }
\group_begin:
  \char_set_catcode_active:N \>
  \cs_new_protected:Npn \__hustdoc_module_star:w #1 > #2 \q_stop
    {
      \tl_set:Nn \l__hustdoc_tmpa_tl {#2}
      \tl_if_eq:NNTF \l__hustdoc_tmpa_tl \c__hustdoc_active_cr_tl
        {
          \__hustdoc_output_module:nn
            { \__hustdoc_star_color: }
            {
              \__hustdoc_module_push:n
                { \__hustdoc_module_angle:n {#1} }
            }
        }
        {
          \__hustdoc_output_module_left:nn
            { \__hustdoc_star_color: }
            {
              \__hustdoc_module_push:n
                { \__hustdoc_module_angle:n {#1} }
            }
        }
      \__hustdoc_output_line:n {#2}
    }
  \cs_new_protected:Npn \__hustdoc_module_slash:w #1 > #2 \q_stop
    {
      \tl_set:Nn \l__hustdoc_tmpa_tl {#2}
      \tl_if_eq:NNTF \l__hustdoc_tmpa_tl \c__hustdoc_active_cr_tl
        {
          \__hustdoc_output_module:nn
            { \__hustdoc_slash_color: }
            {
              \__hustdoc_module_pop:n
                { \__hustdoc_module_angle:n {#1} }
            }
        }
        {
          \__hustdoc_output_module_left:nn
            { \__hustdoc_slash_color: }
            {
              \__hustdoc_module_pop:n
                { \__hustdoc_module_angle:n {#1} }
            }
        }
      \__hustdoc_output_line:n {#2}
    }
  \cs_new_protected:Npn \__hustdoc_module_at:w @ @ = #1 > #2 \q_stop
    {
      \__hustdoc_output_module:nn
        { \color { at@guard } }
        { \__hustdoc_module_angle:n { @ @ = #1 } }
      \tl_gset:Nn \g__codedoc_module_name_tl {#1}
      \__hustdoc_output_line:n {#2}
    }
  \cs_new_protected:Npn \__hustdoc_module_verb:w #1 \q_stop
    {
      \cs_gset_eq:NN \__hustdoc_macro_code_process_line:
        \__hustdoc_process_verbatim_line:
      \tl_gset:Nx \g__hustdoc_macro_code_verbatim_stop_tl
        { \c_percent_str \tl_tail:n {#1} }
      \__hustdoc_output_module:nn
        { \color { verb@guard } }
        {
          \__hustdoc_swap_cr:
          \__hustdoc_module_push:n { \l__hustdoc_macro_code_line_tl }
        }
    }
  \cs_new_protected:Npn \__hustdoc_module_pm:w #1 > #2 \q_stop
    {
      \__hustdoc_output_module_left:nn
        { \__hustdoc_pm_color: }
        { \__hustdoc_module_angle:n {#1} }
      \__hustdoc_output_line:n {#2}
    }
\group_end:
\cs_new_protected:Npn \__hustdoc_output_line:n #1
  {
    \tl_set:Nn \l__hustdoc_macro_code_line_tl {#1}
    \tl_if_eq:NNTF
      \l__hustdoc_macro_code_line_tl \c__hustdoc_active_cr_tl
      { \tl_use:N \l__hustdoc_macro_code_line_tl }
      {
        \str_if_eq:eeTF
          { \str_head:N \l__hustdoc_macro_code_line_tl } { \c_percent_str }
          { \__hustdoc_output_comment_line: } { \__hustdoc_output_line: }
      }
  }
\cs_new_protected_nopar:Npn \__hustdoc_output_line:
  {
    \tex_noindent:D
    \__hustdoc_replace_at_at:N \l__hustdoc_macro_code_line_tl
    \tl_use:N \l__hustdoc_macro_code_line_tl
  }
\cs_new_protected:Npn \__hustdoc_output_comment_line:
  {
    \tex_noindent:D
    \group_begin:
      \__hustdoc_swap_cr:
      \color { code@gray } \slshape \__hustdoc_output_line:
    \group_end:
  }
\cs_new_protected:Npn \__hustdoc_replace_at_at:N #1
  {
    \tl_if_empty:NF \g__codedoc_module_name_tl
      { \__hustdoc_replace_at_at_aux:No #1 \g__codedoc_module_name_tl }
  }
\cs_new_protected:Npn \__hustdoc_replace_at_at_aux:Nn #1#2
  {
    \tl_replace_all:Nnn #1 { _ @ @ } { _ _ #2 }
    \tl_replace_all:Nnn #1 { @ @ } { _ _ #2 }
  }
\cs_generate_variant:Nn \__hustdoc_replace_at_at_aux:Nn { No }
\cs_new_protected_nopar:Npn \__hustdoc_module_push:n
  { \__hustdoc_module_push_aux:on { \int_use:N \c@HD@hypercount } }
\cs_new_protected:Npn \__hustdoc_module_push_aux:nn #1
  {
    \seq_gpush:Nn \g__hustdoc_module_dest_seq {#1}
    \hypersetup { hidelinks }
    \exp_args:Nx \hdclindex
      { \zref@extractdefault { HD.#1 } { guard@end } { 1 } } { }
  }
\cs_generate_variant:Nn \__hustdoc_module_push_aux:nn { on }
\cs_new_protected_nopar:Npn \__hustdoc_module_pop:n
  {
    \seq_gpop:NNTF \g__hustdoc_module_dest_seq \l__hustdoc_tmpa_tl
      { \__hustdoc_module_pop_aux:on { \l__hustdoc_tmpa_tl } }
      { \BOOM \use:n }
  }
\cs_new_protected:Npn \__hustdoc_module_pop_aux:nn #1
  {
    \zref@labelbylist { HD.#1 } { hustdoc }
    \hypersetup { hidelinks }
    \hdclindex {#1} { }
  }
\cs_generate_variant:Nn \__hustdoc_module_pop_aux:nn { on }
\seq_new:N \g__hustdoc_module_dest_seq
\zref@newlist { hustdoc }
\zref@newprop { guard@end } [ 1 ]
  { \int_eval:n { \c@HD@hypercount - 1 } }
\zref@addprop { hustdoc } { guard@end }
\cs_set_protected:Npn \MacroFont
  {
    \linespread { 1.05 }
    \small \ttfamily \mdseries \upshape
  }
\cs_new_protected:Npn \__hustdoc_output_module:nn #1#2
  {
    \tex_noindent:D
    \group_begin:
      #1
      \footnotesize \normalfont \sffamily #2
    \group_end:
  }
\cs_new_protected:Npn \__hustdoc_output_module_left:nn #1#2
  {
    \tex_noindent:D
    \hbox_overlap_left:n
      {
        \__hustdoc_output_module:nn {#1} {#2}
        \skip_horizontal:n { \leftskip + \smallskipamount }
      }
  }
\cs_new_protected_nopar:Npn \__hustdoc_star_color:
  {
    \seq_gpop:NNTF \g__hustdoc_star_color_seq \current@color
      { \set@color }
      { \__hustdoc_select_color: }
    \seq_gpush:No \g__hustdoc_slash_color_seq { \current@color }
  }
\cs_new_protected_nopar:Npn \__hustdoc_slash_color:
  {
    \seq_gpop:NNTF \g__hustdoc_slash_color_seq \current@color
      {
        \set@color
        \seq_gpush:No \g__hustdoc_star_color_seq { \current@color }
      }
      { \BOOM }
  }
\cs_new_protected_nopar:Npn \__hustdoc_pm_color:
  {
    \seq_get:NNTF \g__hustdoc_star_color_seq \current@color
      { \set@color }
      {
        \__hustdoc_select_color:
        \seq_gpush:No \g__hustdoc_star_color_seq { \current@color }
      }
  }
\seq_new:N \g__hustdoc_star_color_seq
\seq_new:N \g__hustdoc_slash_color_seq
\cs_new_protected_nopar:Npn \__hustdoc_select_color:
  { \color { guard@series!!+ } }
\definecolorseries { guard@series }
  { cmyk } { last } { blue } { purple }
\resetcolorseries [ 3 ] { guard@series }
\definecolor { verb@guard } { named } { MaterialLime600 }
\definecolor { at@guard } { named } { MaterialPink }
\definecolor { code@gray } { named } { MaterialGrey }
\cs_new_protected:Npn \__hustdoc_module_angle:n #1
  { < #1 > }
\cs_new_protected_nopar:Npn \__hustdoc_code_line_no:
  {
    \int_gincr:N \c@CodelineNo
    \hbox_overlap_left:n
      {
        \hbox_to_wd:nn
          { \MacroIndent }
          {
            \HD@target
            \tex_hss:D \__hustdoc_code_line_no_style:
            \theCodelineNo \enspace
          }
        \tex_kern:D \@totalleftmargin
      }
  }
\tl_set:Nn \theCodelineNo { \arabic { CodelineNo } }
\cs_new_protected_nopar:Npn \__hustdoc_code_line_no_style:
  { \color { code@gray } \normalfont \sffamily \tiny }
\cs_set_protected:Npn \HD@SetMacroIndent #1
  {
    \group_begin:
      \settowidth \MacroIndent
        {
          \__hustdoc_code_line_no_style:
          \prg_replicate:nn { \tl_count:n {#1} } { 0 }
          \enspace
        }
      \dim_gset_eq:NN \MacroIndent \MacroIndent
    \group_end:
  }

\cs_new_eq:NN \__hustdoc_ltx_changes:nnn \changes@
\cs_set_protected:Npn \changes@ #1#2
  {
    \__hustdoc_save_version_date:nn {#1} {#2}
    \__hustdoc_ltx_changes:nnn {#1} {#2}
  }
\prop_new:N \g__hustdoc_version_date_prop
\cs_new_protected:Npn \__hustdoc_save_version_date:nn #1#2
  {
    \prop_get:NnNTF \g__hustdoc_version_date_prop
      {#1} \l__hustdoc_tmpa_tl
      {
        \exp_after:wN
          \__hustdoc_save_version_date_aux:nnnn \l__hustdoc_tmpa_tl
        {#2} {#1}
      }
      { \__hustdoc_save_version_date_aux:nnn {#1} {#2} {#2} }
  }
\cs_new_protected:Npn \__hustdoc_save_version_date_aux:nnnn #1#2#3#4
  {
    \__hustdoc_if_date_later:nnTF {#1} {#3}
      { \__hustdoc_save_version_date_aux:nnn {#4} {#3} {#2} }
      {
        \__hustdoc_if_date_later:nnT {#3} {#2}
          { \__hustdoc_save_version_date_aux:nnn {#4} {#1} {#3} }
      }
  }
\cs_new_protected:Npn \__hustdoc_save_version_date_aux:nnn #1#2#3
  { \prop_gput:Nnn \g__hustdoc_version_date_prop {#1} { {#2} {#3} } }
\prg_new_conditional:Npnn \__hustdoc_if_date_later:nn #1#2 { TF, T }
  {
    \if_int_compare:w
        \__hustdoc_parse_date:w #1 / / / 0 \q_stop >
        \__hustdoc_parse_date:w #2 / / / 0 \q_stop \exp_stop_f:
      \prg_return_true:
    \else:
      \prg_return_false:
    \fi:
  }
\cs_new:Npn \__hustdoc_parse_date:w #1-#2-#3/ #4 \q_stop
  { #1#2#3 }
\cs_new_protected:Npn \CTEX@versionitem #1 \efill
  {
    \@idxitem
    \prop_get:NnNTF \g__hustdoc_version_date_prop
      {#1} \l__hustdoc_tmpa_tl
      {
        \exp_after:wN
          \__hustdoc_print_version_date:nnn \l__hustdoc_tmpa_tl
        {#1}
      }
      { \BOOM }
  }
\cs_new_protected:Npn \__hustdoc_print_version_date:nnn #1#2#3
  {
    \noindent
    \Hy@raisedlink { \belowpdfbookmark {#3} { HD.#3 } }
    \textbf {#3} \hfill
    \hbox:n
      {
        \footnotesize
        \str_if_eq:nnTF {#1} {#2}
          { ( #1 ) } { ( #1 \c_space_tl \c_tilde_str \c_space_tl #2 ) }
      }
    \par \nopagebreak
  }
\ctex_patch_cmd:Nnn \HDorg@theglossary
  { \let \item \@idxitem }
  { \let \item \CTEX@versionitem }
\ctex_patch_cmd:Nnn \@wrglossary
  { hdpindex }
  {
    \ifnum \c@HD@hypercount = \z@
      hdpindex
    \else
      hdclindex { \the \c@HD@hypercount }
    \fi
  }
%% 
%%     This work consists of the files hustthesis.dtx
%%               and the derived files hustthesis.ins,
%%                                     hustthesis.cls,
%%                                     hustthesis-doc.sty,
%%                                     hustthesis-m.def,
%%                                     hustthesis-d.def,
%%                                     hustthesis.cbx,
%%                                     hustthesis.bbx.
%% 
%%
%% End of file `hustthesis-doc.sty'.
